(()=>{"use strict";const e=(e,...s)=>{const i=document.createElement(e),r=s.map(e=>e instanceof HTMLElement?e:e instanceof Attr?t(i,e):e instanceof n?i.addEventListener(e.type,e.callback):"object"==typeof e?o(i,e):document.createTextNode(e)).filter(e=>null!=e);return i.replaceChildren(...r),i},t=(e,t)=>{if(e.hasAttribute(t.name)){const o=e.getAttribute(t.name);e.setAttribute(t.name,o+" "+t.value)}else e.setAttributeNode(t.cloneNode(!0))},o=(e,t)=>{Object.keys(t).forEach(o=>{if(e.hasAttribute(o)){const n=e.getAttribute(o);e.setAttribute(o,n+" "+t[o])}else e.setAttribute(o,t[o])})};class n{constructor(e,t){this.type=e,this.callback=t}}const s=(e,t)=>new n(e,t),i=(...t)=>e("a",...t),r=(...t)=>e("fieldset",...t),c=(...t)=>e("hr",...t),a=(...t)=>e("input",...t),l=(...t)=>e("label",...t),d=(...t)=>e("legend",...t),u=(...t)=>e("p",...t),p=(...t)=>e("td",...t),b=(...t)=>e("tr",...t),f=(...t)=>e("output",...t),m=(...t)=>e("samp",...t),h=(...t)=>((...t)=>e("button",...t))({type:"button"},...t),g=a({id:"connection"}),k=a({id:"message"}),y=h("Connect",{id:"connect-button"}),v=h("Disconnect",{id:"disconnect-button"}),A=h("Send",{id:"send-button"}),w=f({id:"outgoing"}),S=f({id:"incoming"}),E=f({id:"status"});let C=null;const P=()=>{E.setAttribute("type","open")},L=e=>{console.log(e)},D=()=>{E.setAttribute("type","closed"),C=null},M=()=>{E.setAttribute("type","failed"),C=null},N=t=>{const o=t.target,n=t.type,s="keydown"===n?t.key:null;switch(!0){case o===g&&"Enter"===s:case o===y&&"click"===n:if(g.value)try{C=new WebSocket(g.value),E.setAttribute("type","loading"),C.addEventListener("open",P),C.addEventListener("message",L),C.addEventListener("close",D),C.addEventListener("error",M)}catch(e){console.error(e),E.setAttribute("type","failed")}break;case o===v&&"click"===n:C?.readyState===WebSocket.OPEN&&C.close();break;case o===k&&"Enter"===s:case o===A&&"click"===n:k.value&&C?.readyState===WebSocket.OPEN&&(C.send(k.value),w.prepend(((...t)=>e("pre",...t))(((...t)=>e("code",...t))(k.value)),c()))}},W=[i("MDN Docs for WebSocket API",{href:"https://developer.mozilla.org/en-US/docs/Web/API/WebSocket"}),i("MDN Docs for CSS Grid",{href:"https://developer.mozilla.org/en-US/docs/Glossary/Grid"}),i("Blog post about Event Delegation",{href:"https://javascript.info/event-delegation"}),i("Plain HTML page on TCP sockets in C",{href:"https://www.cs.rpi.edu/~moorthy/Courses/os98/Pgms/socket.html"}),i("Stack overflow on reading from sockets in C",{href:"https://stackoverflow.com/questions/666601/what-is-the-correct-way-of-reading-from-a-tcp-socket-in-c-c"})],T=[((...t)=>e("header",...t))(e("h1","TCP Pertubation & Response"),u("A simple interface for making and probing TCP connections using the"," WebSocket API.")),((...t)=>e("main",...t))(((...t)=>e("form",...t))(s("click",N),s("keydown",N),r(d("Input"),l("Connection URI",{for:g.id}),g,y,v,e("br"),l("Connection status",{for:E.id}),E,c(),l("Message",{for:k.id}),k,A),r(d("Output"),((...t)=>e("table",...t))(b(p(l("Pertubation",{for:w.id})),p(l("Response",{for:S.id}))),b(p(m(w)),p(m(S)))))),((...t)=>e("details",...t))(e("summary","Sources"),((...t)=>e("ul",...t))(...W.map(t=>((...t)=>e("li",...t))(t))))),((...t)=>e("footer",...t))(u("by Mozzie Dvorak // with ",i("Ellipsi",{href:"https://www.npmjs.com/package/ellipsi"})," // view ",i("page source",{href:"https://github.com/mdvorak340/mdvorak340.github.io/tree/main/tcp"})))],I=()=>{document.body.replaceChildren(...T)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",I):I()})();